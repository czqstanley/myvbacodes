Sub movedataover()
Dim a As Integer
Dim b As Integer
Dim c As Integer
Dim d As Integer
Dim e As Integer
e = 1

Dim sFname As String
Dim sPath As String
Dim wbk As Workbook
Dim nwbk As Workbook

Set nwbk = Workbooks.Add
newfilename = InputBox("save as")
nwbk.SaveAs (sPath & "\" & newfilename & ".xlsx")
Workbooks.Open (sPath & "\" & newfilename & ".xlsx")

b = InputBox("source column number")
c = InputBox("target column number")


'count file numbers
d = 1
Do Until IsEmpty(Cells(d, 1).Value) = True
d = d + 1
Loop


Dim sourcenames() As String
ReDim sourcenames(d)
For i = 1 To d
sourcenames(i) = Cells(i, 1).Value
Next

Application.EnableEvents = False
Application.ScreenUpdating = False


For l = 1 To d
sFname = sourcenames(l)
sPath = ThisWorkbook.Path
ChDir sPath
sFname = Dir(sPath & "\" & sourcenames(l) & ".xl*", vbNormal)
Set wbk = Workbooks.Open(sFname)
Windows(sFname).Activate
Worksheets("sheet1").Activate
a = 1
Do Until IsEmpty(Cells(a, 1).Value) = True
a = a + 1
Loop

    Dim original() As Variant
    ReDim original(a)

    For i = 1 To a
    original(i) = Cells(i, b).Value
    Next

Windows(sPath & "\" & newfilename & ".xlsx").Activate
Worksheets("sheet1").Activate

For k = 1 To a
Cells(e, c).Value = original(k)
e = e + 1
Next

Windows(sFname).Activate
Workbooks(sFname).Close

Next


End Sub



